import{a as me,b as F}from"./chunk-7IBTK74P.js";import{a as P}from"./chunk-MJBOIPQL.js";import"./chunk-UAOFOE2L.js";import{a as le,b as pe,f as se,n as ce}from"./chunk-WPXTPOO6.js";import{$ as V,Ac as Z,Ca as E,Cc as $,Da as g,Dc as ee,Ea as w,I as x,Jb as j,Kc as ie,Lc as te,Mc as oe,N as m,Na as W,Nc as re,O as d,Oa as c,Oc as ne,P as v,Pa as D,Q as C,Qa as H,Sa as T,Ta as y,Ua as M,Va as N,Wa as z,Y as k,Ya as X,Yb as q,Yc as ae,Zb as R,_ as o,dc as O,ec as U,ja as S,la as l,pa as B,ra as b,sa as I,sb as A,ua as L,uc as J,va as G,wa as t,wc as K,xa as r,ya as f,yc as Q,zc as Y}from"./chunk-3WV2BAOI.js";import"./chunk-IGH4DTA6.js";var de=a=>({row_selected:a});function _e(a,_){a&1&&(t(0,"h5",12),c(1,"Nuevo Propietario"),r())}function ue(a,_){a&1&&(t(0,"h5",12),c(1,"Edici\xF3n de Propietario"),r())}function he(a,_){a&1&&f(0,"i",29)}function ge(a,_){if(a&1&&c(0),a&2){let u=w().$index;H(" ",u+1," ")}}function fe(a,_){if(a&1&&f(0,"img",30),a&2){let u=w().$implicit;l("src","data:"+u.photo.type+";base64,"+u.photo.file_base64,k)}}function ve(a,_){if(a&1){let u=E();t(0,"tr",27),g("click",function(){let n=m(u).$implicit,e=w();return d(e.propietario_selected=n)}),t(1,"th",28),S(2,he,1,0,"i",29)(3,ge,1,1),r(),t(4,"th"),S(5,fe,1,1,"img",30),r(),t(6,"td"),c(7),r(),t(8,"td"),c(9),r()()}if(a&2){let u=_.$implicit,i=w();B(X(7,de,i.propietario_selected==u)),o(2),b(i.propietario_selected==u?2:-1),o(),b(i.propietario_selected!==u?3:-1),o(2),b(u.photo!=null?5:-1),o(2),D(u.name),o(2),D(u.description)}}var Ae=(()=>{let _=class _{constructor(i,n){this.catalogService=i,this.filesService=n,this.filter="",this.fotografias=[],this.propietarios=[],this.propietarios_shown=[],this.propietario_selected={name:"",photo_id:"",description:"",photo:null},this.visible=!1,this.is_new=!1}ngOnInit(){this.get_catalog()}get_catalog(){this.propietarios=[],this.propietario_selected={name:"",photo_id:"",description:"",photo:null},this.catalogService.get_items("propietarios",{name:!0,photo_id:!0,description:!0}).then(i=>{this.propietarios=i.response,this.propietarios.forEach(n=>{this.filesService.get_file("fotografias_propietarios",n.photo_id).then(e=>{n.photo=e.response}).catch(e=>console.log(e))}),this.filterData()}).catch(i=>console.log(i))}new_item(){this.propietario_selected={name:"",photo_id:"",description:"",photo:null},this.is_new=!0}filterData(){let i=this.filter.toLowerCase();this.propietarios_shown=this.propietarios.filter(n=>n.name.toLowerCase().includes(i)||n.description.toLowerCase().includes(i))}cancelar(){this.visible=!this.visible,this.get_catalog()}handleChange(i){this.visible=i}save(){let i={name:this.propietario_selected.name,photo_id:"",description:this.propietario_selected.description};this.propietario_selected.photo_id&&this.filesService.delete_file("fotografias_propietarios",this.propietario_selected.photo_id),this.fotografias.forEach(n=>{this.filesService.upload_files("fotografias_propietarios",this.fotografias).then(e=>{e.status==200&&(i.photo_id=e.response[0].file_id,this.is_new?this.upload_item(i,"propietarios"):(i.item_id=this.propietario_selected.item_id,this.update_item(i,"propietarios")))}).catch(e=>console.log(e))}),this.visible=!this.visible}update_item(i,n){this.catalogService.update_item(n,i.item_id,i).then(e=>{this.get_catalog()}).catch(e=>console.log(e))}delete_item(i,n){this.catalogService.delete_item(n,i.item_id).then(e=>{this.get_catalog()}).catch(e=>console.log(e))}upload_item(i,n){this.catalogService.upload_items(n,[i]).then(e=>{this.get_catalog()}).catch(e=>console.log(e))}cargar_fotografia(i){i.validated&&(this.fotografias=i.files)}};_.\u0275fac=function(n){return new(n||_)(V(P),V(F))},_.\u0275cmp=x({type:_,selectors:[["app-propietarios"]],standalone:!0,features:[N([P,F]),z],decls:59,vars:32,consts:[["modalXl",""],[1,"g-3","mb-2"],[3,"sm"],["aria-label","Toolbar with button groups","role","group"],["aria-label","Basic example","role","group",1,"me-2"],["cButton","","color","primary","title","Nuevo",3,"click","cModalToggle"],["cIcon","","size","1xl",3,"name","title"],["cButton","","color","warning","title","Editar",3,"click","cModalToggle","disabled"],["cButton","","color","danger","title","Eliminar",3,"click","disabled"],["cInputGroupText",""],["cFormControl","","id","autoSizingInputGroup","placeholder","Buscar",3,"ngModelChange","keyup","ngModel"],["id","modalXl","size","xl",3,"visibleChange","visible"],["cModalTitle",""],["cButtonClose","",3,"click"],["cLabel",""],[3,"files_uploaded","accept","files","folder","max_file_count","max_file_size","required"],[1,"mb-3",3,"cFormFloating"],["cFormControl","","id","floatingInput","placeholder","Nombre Completo del Propietario","type","text",3,"ngModelChange","ngModel"],["cLabel","","for","floatingInput"],["cFormControl","","id","floatingInput","placeholder","Descripci\xF3n del Propietario",3,"ngModelChange","ngModel"],["aria-label","Basic example","role","group",1,"m-auto"],["cButton","","color","primary","title","Guardar",3,"click"],["cButton","","color","danger","title","Cancelar",3,"click"],[1,"row",2,"max-height","75vh","overflow-y","auto"],["cTable","","hover",""],["scope","col"],[3,"class"],[3,"click"],["scope","row"],[1,"fa-regular","fa-hand-point-right"],[1,"mb-2",2,"max-height","100px","min-height","100px","border-radius","50%",3,"src"]],template:function(n,e){if(n&1){let p=E();t(0,"c-row",1)(1,"c-col",2)(2,"c-button-toolbar",3)(3,"c-button-group",4)(4,"button",5),g("click",function(){return m(p),d(e.new_item())}),v(),f(5,"svg",6),r(),C(),t(6,"button",7),g("click",function(){return m(p),d(e.is_new=!1)}),v(),f(7,"svg",6),r(),C(),t(8,"button",8),g("click",function(){return m(p),d(e.delete_item(e.propietario_selected,"propietarios"))}),v(),f(9,"svg",6),r()()()(),C(),t(10,"c-col",2)(11,"c-input-group")(12,"span",9),v(),f(13,"svg",6),r(),C(),t(14,"input",10),M("ngModelChange",function(s){return m(p),y(e.filter,s)||(e.filter=s),d(s)}),g("keyup",function(){return m(p),d(e.filterData())}),r()()()(),t(15,"c-modal",11,0),g("visibleChange",function(s){return m(p),d(e.handleChange(s))}),t(17,"c-modal-header"),S(18,_e,2,0,"h5",12)(19,ue,2,0,"h5",12),t(20,"button",13),g("click",function(){return m(p),d(e.cancelar())}),r()(),t(21,"c-modal-body")(22,"c-col",2)(23,"h5",14)(24,"b"),c(25,"Fotograf\xEDa:"),r()(),t(26,"app-file-drop",15),g("files_uploaded",function(s){return m(p),d(e.cargar_fotografia(s))}),r()(),t(27,"div",16)(28,"input",17),M("ngModelChange",function(s){return m(p),y(e.propietario_selected.name,s)||(e.propietario_selected.name=s),d(s)}),r(),t(29,"label",18),c(30,"Nombre Completo del Propietario"),r()(),t(31,"div",16)(32,"textarea",19),M("ngModelChange",function(s){return m(p),y(e.propietario_selected.description,s)||(e.propietario_selected.description=s),d(s)}),r(),t(33,"label",18),c(34,"Descripci\xF3n del Propietario"),r()(),t(35,"c-row",1)(36,"c-button-toolbar",3)(37,"c-button-group",20)(38,"button",21),g("click",function(){return m(p),d(e.save())}),v(),f(39,"svg",6),c(40," Guardar"),r(),C(),t(41,"button",22),g("click",function(){return m(p),d(e.cancelar())}),v(),f(42,"svg",6),c(43," Cancelar"),r()()()()()(),C(),t(44,"div",23)(45,"table",24)(46,"thead")(47,"tr")(48,"th",25),c(49,"#"),r(),t(50,"th",25),c(51,"Fotograf\xEDa"),r(),t(52,"th",25),c(53,"Nombre Completo"),r(),t(54,"th",25),c(55,"Descripci\xF3n"),r()()(),t(56,"tbody"),L(57,ve,10,9,"tr",26,I),r()()()}if(n&2){let p=W(16);o(),l("sm",7),o(3),l("cModalToggle",p.id),o(),l("name","cilPlus")("title","cilPlus"),o(),l("cModalToggle",p.id)("disabled",e.propietario_selected.name==""),o(),l("name","cilPen")("title","cilPen"),o(),l("disabled",e.propietario_selected.name==""),o(),l("name","cilTrash")("title","cilTrash"),o(4),l("name","cilSearch")("title","cilSearch"),o(),T("ngModel",e.filter),o(),l("visible",e.visible),o(3),b(e.propietario_selected.name==""?18:-1),o(),b(e.propietario_selected.name!==""?19:-1),o(3),l("sm",12),o(4),l("accept","image/*")("files",e.fotografias)("folder","fotografias_propietarios")("max_file_count",1)("max_file_size",10)("required",!0),o(),l("cFormFloating",!0),o(),T("ngModel",e.propietario_selected.name),o(3),l("cFormFloating",!0),o(),T("ngModel",e.propietario_selected.description),o(7),l("name","cilSave")("title","cilSave"),o(3),l("name","cilX")("title","cilX"),o(15),G(e.propietarios_shown)}},dependencies:[me,Y,ce,le,pe,se,O,U,j,A,J,Z,Q,K,ae,R,q,$,ee,ne,oe,re,ie,te]});let a=_;return a})();export{Ae as PropietariosComponent};
