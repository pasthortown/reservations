import{a as I}from"./chunk-UAOFOE2L.js";import{$ as E,Ca as C,D as z,Da as D,E as R,Ea as h,G as ee,Ha as k,I as N,J as V,Ja as de,K as P,Ka as ce,La as q,M as te,Ma as U,N as g,Na as pe,O as v,Oa as m,Pa as L,Qa as O,V as F,Va as fe,Wa as ue,Y as ie,Ya as me,_ as d,aa as A,ab as he,ca as ne,ea as Z,ja as x,ka as re,kb as _e,la as b,m as Y,mb as ge,na as oe,ob as ve,qb as be,ra as y,rb as ye,sa as se,ua as le,va as ae,wa as p,xa as f,ya as w}from"./chunk-3WV2BAOI.js";import{d as Ce,e as Fe}from"./chunk-IGH4DTA6.js";var De=Ce((G,J)=>{"use strict";(function(n,r){typeof define=="function"&&define.amd?define([],r):typeof G<"u"?r():(r(),n.FileSaver={})})(G,function(){"use strict";function n(o,s){return typeof s>"u"?s={autoBom:!1}:typeof s!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function r(o,s,u){var c=new XMLHttpRequest;c.open("GET",o),c.responseType="blob",c.onload=function(){l(c.response,s,u)},c.onerror=function(){console.error("could not download file")},c.send()}function a(o){var s=new XMLHttpRequest;s.open("HEAD",o,!1);try{s.send()}catch{}return 200<=s.status&&299>=s.status}function e(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(s)}}var t=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,i=t.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=t.saveAs||(typeof window!="object"||window!==t?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(o,s,u){var c=t.URL||t.webkitURL,_=document.createElement("a");s=s||o.name||"download",_.download=s,_.rel="noopener",typeof o=="string"?(_.href=o,_.origin===location.origin?e(_):a(_.href)?r(o,s,u):e(_,_.target="_blank")):(_.href=c.createObjectURL(o),setTimeout(function(){c.revokeObjectURL(_.href)},4e4),setTimeout(function(){e(_)},0))}:"msSaveOrOpenBlob"in navigator?function(o,s,u){if(s=s||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(n(o,u),s);else if(a(o))r(o,s,u);else{var c=document.createElement("a");c.href=o,c.target="_blank",setTimeout(function(){e(c)})}}:function(o,s,u,c){if(c=c||open("","_blank"),c&&(c.document.title=c.document.body.innerText="downloading..."),typeof o=="string")return r(o,s,u);var _=o.type==="application/octet-stream",we=/constructor/i.test(t.HTMLElement)||t.safari,K=/CriOS\/[\d]+/.test(navigator.userAgent);if((K||_&&we||i)&&typeof FileReader<"u"){var M=new FileReader;M.onloadend=function(){var T=M.result;T=K?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),c?c.location.href=T:location=T,c=null},M.readAsDataURL(o)}else{var W=t.URL||t.webkitURL,j=W.createObjectURL(o);c?c.location=j:location.href=j,c=null,setTimeout(function(){W.revokeObjectURL(j)},4e4)}});t.saveAs=l.saveAs=l,typeof J<"u"&&(J.exports=l)})});var Se=["fileSelector"],Te=n=>({openFileSelector:n});function Oe(n,r){if(n&1&&(p(0,"div",8),m(1),f()),n&2){let a=h(2);d(),L(a.dropZoneLabel)}}function Ie(n,r){if(n&1){let a=C();p(0,"div")(1,"input",9),D("click",function(t){g(a);let i=h(2);return v(i.openFileSelector(t))}),f()()}if(n&2){let a=h(2);d(),k("value",a.browseBtnLabel),b("className",a.browseBtnClassName)}}function ze(n,r){if(n&1&&x(0,Oe,2,1,"div",6)(1,Ie,2,2,"div",7),n&2){let a=h();b("ngIf",a.dropZoneLabel),d(),b("ngIf",a.showBrowseBtn)}}function Ne(n,r){}var S=class{constructor(r,a){this.relativePath=r,this.fileEntry=a}},Q=(()=>{let r=class r{constructor(e){this.template=e}};r.\u0275fac=function(t){return new(t||r)(E(A))},r.\u0275dir=P({type:r,selectors:[["","ngx-file-drop-content-tmp",""]]});let n=r;return n})(),$=(()=>{let r=class r{get disabled(){return this._disabled}set disabled(e){this._disabled=e!=null&&`${e}`!="false"}constructor(e,t){this.zone=e,this.renderer=t,this.accept="*",this.directory=!1,this.multiple=!0,this.dropZoneLabel="",this.dropZoneClassName="ngx-file-drop__drop-zone",this.useDragEnter=!1,this.contentClassName="ngx-file-drop__content",this.showBrowseBtn=!1,this.browseBtnClassName="btn btn-primary btn-xs ngx-file-drop__browse-btn",this.browseBtnLabel="Browse files",this.onFileDrop=new F,this.onFileOver=new F,this.onFileLeave=new F,this.isDraggingOverDropZone=!1,this.globalDraggingInProgress=!1,this.files=[],this.numOfActiveReadEntries=0,this.helperFormEl=null,this.fileInputPlaceholderEl=null,this.dropEventTimerSubscription=null,this._disabled=!1,this.openFileSelector=i=>{this.fileSelector&&this.fileSelector.nativeElement&&this.fileSelector.nativeElement.click()},this.globalDragStartListener=this.renderer.listen("document","dragstart",i=>{this.globalDraggingInProgress=!0}),this.globalDragEndListener=this.renderer.listen("document","dragend",i=>{this.globalDraggingInProgress=!1})}ngOnDestroy(){this.dropEventTimerSubscription&&(this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=null),this.globalDragStartListener(),this.globalDragEndListener(),this.files=[],this.helperFormEl=null,this.fileInputPlaceholderEl=null}onDragOver(e){this.useDragEnter?(this.preventAndStop(e),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")):!this.isDropzoneDisabled()&&!this.useDragEnter&&e.dataTransfer&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(e)),this.preventAndStop(e),e.dataTransfer.dropEffect="copy")}onDragEnter(e){!this.isDropzoneDisabled()&&this.useDragEnter&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(e)),this.preventAndStop(e))}onDragLeave(e){this.isDropzoneDisabled()||(this.isDraggingOverDropZone&&(this.isDraggingOverDropZone=!1,this.onFileLeave.emit(e)),this.preventAndStop(e))}dropFiles(e){if(!this.isDropzoneDisabled()&&(this.isDraggingOverDropZone=!1,e.dataTransfer)){let t;e.dataTransfer.items?t=e.dataTransfer.items:t=e.dataTransfer.files,this.preventAndStop(e),this.checkFiles(t)}}uploadFiles(e){if(!this.isDropzoneDisabled()&&e.target){let t=e.target.files||[];this.checkFiles(t),this.resetFileInput()}}getFakeDropEntry(e){let t={name:e.name,isDirectory:!1,isFile:!0,file:i=>i(e)};return new S(t.name,t)}checkFile(e){if(e){if("webkitGetAsEntry"in e){let t=e.webkitGetAsEntry();if(t){if(t.isFile){let i=new S(t.name,t);this.addToQueue(i)}else t.isDirectory&&this.traverseFileTree(t,t.name);return}}this.addToQueue(this.getFakeDropEntry(e))}}checkFiles(e){for(let t=0;t<e.length;t++)this.checkFile(e[t]);this.dropEventTimerSubscription&&this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=Y(200,200).subscribe(()=>{if(this.files.length>0&&this.numOfActiveReadEntries===0){let t=this.files;this.files=[],this.onFileDrop.emit(t)}})}traverseFileTree(e,t){if(e.isFile){let i=new S(t,e);this.files.push(i)}else{t=t+"/";let i=e.createReader(),l=[],o=()=>{this.numOfActiveReadEntries++,i.readEntries(s=>{if(s.length)l=l.concat(s),o();else if(l.length===0){let u=new S(t,e);this.zone.run(()=>{this.addToQueue(u)})}else for(let u=0;u<l.length;u++)this.zone.run(()=>{this.traverseFileTree(l[u],t+l[u].name)});this.numOfActiveReadEntries--})};o()}}resetFileInput(){if(this.fileSelector&&this.fileSelector.nativeElement){let e=this.fileSelector.nativeElement,t=e.parentElement,i=this.getHelperFormElement(),l=this.getFileInputPlaceholderElement();t!==i&&(this.renderer.insertBefore(t,l,e),this.renderer.appendChild(i,e),i.reset(),this.renderer.insertBefore(t,e,l),this.renderer.removeChild(t,l))}}getHelperFormElement(){return this.helperFormEl||(this.helperFormEl=this.renderer.createElement("form")),this.helperFormEl}getFileInputPlaceholderElement(){return this.fileInputPlaceholderEl||(this.fileInputPlaceholderEl=this.renderer.createElement("div")),this.fileInputPlaceholderEl}isDropzoneDisabled(){return this.globalDraggingInProgress||this.disabled}addToQueue(e){this.files.push(e)}preventAndStop(e){e.stopPropagation(),e.preventDefault()}};r.\u0275fac=function(t){return new(t||r)(E(Z),E(ne))},r.\u0275cmp=N({type:r,selectors:[["ngx-file-drop"]],contentQueries:function(t,i,l){if(t&1&&de(l,Q,5,A),t&2){let o;q(o=U())&&(i.contentTemplate=o.first)}},viewQuery:function(t,i){if(t&1&&ce(Se,7),t&2){let l;q(l=U())&&(i.fileSelector=l.first)}},inputs:{accept:"accept",directory:"directory",multiple:"multiple",dropZoneLabel:"dropZoneLabel",dropZoneClassName:"dropZoneClassName",useDragEnter:"useDragEnter",contentClassName:"contentClassName",showBrowseBtn:"showBrowseBtn",browseBtnClassName:"browseBtnClassName",browseBtnLabel:"browseBtnLabel",disabled:"disabled"},outputs:{onFileDrop:"onFileDrop",onFileOver:"onFileOver",onFileLeave:"onFileLeave"},decls:7,vars:15,consts:[["fileSelector",""],["defaultContentTemplate",""],[3,"drop","dragover","dragenter","dragleave","className"],[3,"className"],["type","file",1,"ngx-file-drop__file-input",3,"change","accept","multiple"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ngx-file-drop__drop-zone-label",4,"ngIf"],[4,"ngIf"],[1,"ngx-file-drop__drop-zone-label"],["type","button",3,"click","className","value"]],template:function(t,i){if(t&1){let l=C();p(0,"div",2),D("drop",function(s){return g(l),v(i.dropFiles(s))})("dragover",function(s){return g(l),v(i.onDragOver(s))})("dragenter",function(s){return g(l),v(i.onDragEnter(s))})("dragleave",function(s){return g(l),v(i.onDragLeave(s))}),p(1,"div",3)(2,"input",4,0),D("change",function(s){return g(l),v(i.uploadFiles(s))}),f(),x(4,ze,2,2,"ng-template",null,1,he)(6,Ne,0,0,"ng-template",5),f()()}if(t&2){let l=pe(5);oe("ngx-file-drop__drop-zone--over",i.isDraggingOverDropZone),b("className",i.dropZoneClassName),d(),b("className",i.contentClassName),d(),b("accept",i.accept)("multiple",i.multiple),re("directory",i.directory||void 0)("webkitdirectory",i.directory||void 0)("mozdirectory",i.directory||void 0)("msdirectory",i.directory||void 0)("odirectory",i.directory||void 0),d(4),b("ngTemplateOutlet",i.contentTemplate||l)("ngTemplateOutletContext",me(13,Te,i.openFileSelector))}},dependencies:[_e,ge],styles:[".ngx-file-drop__drop-zone[_ngcontent-%COMP%]{height:100px;margin:auto;border:2px dotted #0782d0;border-radius:30px}.ngx-file-drop__drop-zone--over[_ngcontent-%COMP%]{background-color:#93939380}.ngx-file-drop__content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100px;color:#0782d0}.ngx-file-drop__drop-zone-label[_ngcontent-%COMP%]{text-align:center}.ngx-file-drop__file-input[_ngcontent-%COMP%]{display:none}"]});let n=r;return n})(),xe=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=V({type:r,bootstrap:[$]}),r.\u0275inj=R({imports:[ve]});let n=r;return n})();var Ee=Fe(De(),1);var X;try{X=!!new Blob}catch{X=!1}var B=(()=>{let r=class r{get isFileSaverSupported(){return X}genType(e){if(!e||e.lastIndexOf(".")===-1)return"text/plain";let t=e.substring(e.lastIndexOf(".")+1);switch(t){case"txt":return"text/plain";case"xml":case"html":return`text/${t}`;case"json":return"octet/stream";default:return`application/${t}`}}save(e,t,i,l){if(!e)throw new Error("Data argument should be a blob instance");let o=new Blob([e],{type:i||e.type||this.genType(t)});(0,Ee.saveAs)(o,decodeURI(t||"download"),l)}saveText(e,t,i){let l=new Blob([e]);this.save(l,t,void 0,i)}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=z({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();function Le(n,r){if(n&1&&(p(0,"span")(1,"small"),m(2,"Arrastre aqu\xED el o los archivos que desea compartir."),w(3,"br"),m(4),w(5,"br"),m(6),f()()),n&2){let a=h(3);d(4),O(" Se acepta m\xE1ximo ",a.max_file_size,"MB por cada Archivo."),d(2),O(" Se aceptan m\xE1ximo ",a.max_file_count," archivos.")}}function Be(n,r){if(n&1&&(p(0,"span")(1,"small"),m(2,"Arrastre aqu\xED el archivo que desea compartir."),w(3,"br"),m(4),f()()),n&2){let a=h(3);d(4),O(" El archivo no deber\xE1 superar los ",a.max_file_size,"MB.")}}function Me(n,r){if(n&1){let a=C();p(0,"p",8),D("click",function(){let t=g(a).openFileSelector;return v(t())}),x(1,Le,7,2,"span")(2,Be,5,1,"span"),f()}if(n&2){let a=h(2);d(),y(a.max_file_count>1?1:-1),d(),y(a.max_file_count==1?2:-1)}}function je(n,r){if(n&1){let a=C();p(0,"div",1)(1,"ngx-file-drop",6),D("onFileDrop",function(t){g(a);let i=h();return v(i.dropped(t))}),x(2,Me,3,2,"ng-template",7),f()()}if(n&2){let a=h();d(),k("accept",a.accept)}}function Re(n,r){n&1&&(p(0,"th")(1,"small")(2,"strong"),m(3,"Archivos Cargados"),f()()())}function Ve(n,r){n&1&&(p(0,"th",4)(1,"small")(2,"strong"),m(3,"Fotograf\xEDas"),f()()())}function Pe(n,r){n&1&&(p(0,"th",4)(1,"small")(2,"strong"),m(3,"Fotograf\xEDa"),f()()())}function Ze(n,r){n&1&&(p(0,"th",4)(1,"small")(2,"strong"),m(3,"Fotograf\xEDas y Videos"),f()()())}function qe(n,r){n&1&&(p(0,"th",4),m(1,"\xA0"),p(2,"span",9),m(3,"Incorrecto"),f()())}function Ue(n,r){if(n&1&&(p(0,"td"),w(1,"img",15),f()),n&2){let a=h().$implicit;d(),b("src","data:"+a.type+";base64,"+a.file_base64,ie)}}function He(n,r){if(n&1&&(p(0,"td"),m(1,"\xA0"),p(2,"span",16),m(3),f()()),n&2){let a=h(2);d(3),O("Mayor ",a.max_file_size,"MB")}}function Qe(n,r){if(n&1){let a=C();p(0,"tr")(1,"td")(2,"small"),m(3),f()(),x(4,Ue,2,1,"td")(5,He,4,1,"td"),p(6,"td")(7,"div",10)(8,"button",11),D("click",function(){let t=g(a).$implicit,i=h();return v(i.download(t))}),w(9,"i",12),f(),p(10,"button",13),D("click",function(){let t=g(a).$implicit,i=h();return v(i.delete_file(t))}),w(11,"i",14),f()()()()}if(n&2){let a=r.$implicit,e=h();d(3),L(a.name),d(),y(e.accept=="image/*"?4:-1),d(),y(a.size>e.max_file_size*1024*1024?5:-1),d(5),b("disabled",e.disabled)}}var pt=(()=>{let r=class r{constructor(e){this.fileServerService=e,this.files_uploaded=new F,this.max_file_size=10,this.max_file_count=5,this.disabled=!1,this.required=!0,this.files=[],this.folder="general",this.accept="*",this.validate_file_size=!1}ngOnChanges(){this.validate_files()}delete_file(e){let t=[];this.files.forEach(i=>{i!=e&&t.push(i)}),this.files=t,this.return_files()}dropped(e){this.validate_file_size=!0;for(let t of e)t.fileEntry.isFile&&t.fileEntry.file(l=>{let o=new FileReader;o.readAsDataURL(l),o.onload=()=>{if(o.result!=null)if(this.accept=="image/*"){if(l.type.toString().search("image")!=-1){let s={name:l.name,type:l.type,size:l.size,file_base64:o.result.toString().split(",")[1]};l.size>this.max_file_size*1024*1024&&(this.validate_file_size=!1),this.files.push(s),this.return_files()}}else{let s={name:l.name,type:l.type,size:l.size,file_base64:o.result.toString().split(",")[1]};l.size>this.max_file_size*1024*1024&&(this.validate_file_size=!1),this.files.push(s),this.return_files()}}})}return_files(){this.files_uploaded.emit({files:this.files,validated:this.validate_files()})}validate_files(){this.validate_file_size=!0,this.files.forEach(o=>{o.size>this.max_file_size*1024*1024&&(this.validate_file_size=!1)});let e=this.files.length>this.max_file_count,t=this.files.length==0,i=!this.validate_file_size;return!(e||t||i)}download(e){let t=atob(e.file_base64),i=new Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);let l=new Uint8Array(i),o=new Blob([l],{type:e.type});this.fileServerService.save(o,e.name)}};r.\u0275fac=function(t){return new(t||r)(E(B))},r.\u0275cmp=N({type:r,selectors:[["app-file-drop"]],inputs:{max_file_size:"max_file_size",max_file_count:"max_file_count",disabled:"disabled",required:"required",files:"files",folder:"folder",accept:"accept"},outputs:{files_uploaded:"files_uploaded"},standalone:!0,features:[fe([B]),te,ue],decls:14,vars:6,consts:[[1,"row"],[1,"col-12"],[1,"col-12","mt-3"],[1,"table"],["colspan","2"],[1,"upload-name-style"],["dropZoneLabel","Arrastre los Archivos Aqu\xED",3,"onFileDrop","accept"],["ngx-file-drop-content-tmp",""],[1,"col-12","text-center",3,"click"],[1,"ml-2","badge","bg-danger","text-light"],["role","group",1,"btn-group"],["type","button","title","Descargar",1,"btn","btn-info",3,"click"],[1,"fas","fa-download"],["type","button","title","Eliminar",1,"btn","btn-danger",3,"click","disabled"],[1,"fas","fa-trash-alt"],[1,"rounded","mb-2",2,"max-height","200px","max-width","35%",3,"src"],[1,"ml-2","badge","bg-danger"]],template:function(t,i){t&1&&(p(0,"div",0),x(1,je,3,1,"div",1),p(2,"div",2)(3,"table",3)(4,"thead")(5,"tr"),x(6,Re,4,0,"th")(7,Ve,4,0,"th",4)(8,Pe,4,0,"th",4)(9,Ze,4,0,"th",4)(10,qe,4,0,"th",4),f()(),p(11,"tbody",5),le(12,Qe,12,4,"tr",null,se),f()()()()),t&2&&(d(),y(i.disabled?-1:1),d(5),y(i.accept!="image/*"&&i.accept!="image/*,video/*"?6:-1),d(),y(i.accept=="image/*"&&i.max_file_count>1?7:-1),d(),y(i.accept=="image/*"&&i.max_file_count==1?8:-1),d(),y(i.accept=="image/*,video/*"?9:-1),d(),y(i.files.length>i.max_file_count||i.files.length==0&&i.required||!i.validate_file_size?10:-1),d(2),ae(i.files))},dependencies:[xe,$,Q]});let n=r;return n})();var _t=(()=>{let r=class r{constructor(e){this.http=e,this.options={};let t=new be().set("Content-Type","application/json");this.options={headers:t}}upload_files(e,t){let i={files:t};return this.http.post(I.api_file+e+"/upload_files",JSON.stringify(i),this.options).toPromise()}get_file(e,t){let i={file_id:t};return this.http.post(I.api_file+e+"/get_file",JSON.stringify(i),this.options).toPromise()}delete_file(e,t){let i={file_id:t};return this.http.post(I.api_file+e+"/delete_file",JSON.stringify(i),this.options).toPromise()}update_file(e,t,i){let l={file_id:t,file:i};return this.http.post(I.api_file+e+"/update_file",JSON.stringify(l),this.options).toPromise()}};r.\u0275fac=function(t){return new(t||r)(ee(ye))},r.\u0275prov=z({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();export{pt as a,_t as b};
